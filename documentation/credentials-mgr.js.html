<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: credentials-mgr.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: credentials-mgr.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module
 */
const keytar = require('keytar')
const inquirer = require('inquirer')
const service = process.env.npm_package_name
/**
 * 
 * @typedef secretParam
 * @property name:string  The name for the key to retrieve 
 * @property hide:boolean When creating the key if true hides the user typing
 */

/**
 * If a named credential for our service (based on package name)
 * exists in the local machine's key store get it. Otherwise
 * prompt the user to create it
 * @param {{name:string, hide:boolean}} param  
 * @returns {Promise&lt;string>}  resolves to thes tored secret for the passed name
 * @example getOrCreateSecret({name:'trelloApiKey}, hidden:false)
 */
const getOrCreateSecret = async (param) => {
  const propSecret = await keytar.getPassword(service, param.name)
  if (propSecret === null) {
    return createSecret(param)
  }
  return propSecret
}

/**
 * Create the key in the local machine's key store and allow the user to
 * type in the value. If the hide property is true - typed value will not show
 * @param {{name:string, hide:boolean}} param 
 * @returns {Promise&lt;{name:{secret:string}}>} 
 * for example if user types 123 will return {apiKey:{secret:'123'}}
 * @example createSecret({name:'apiKey', hide:false})
 */
const createSecret = async (param) => {
  const inputType = param.hide ? 'password' : 'input'
  const response = await inquirer.prompt([
    {type: inputType, name: 'secret', message: `Enter a value for ${param.name}`}
  ])
  const {secret} = response
  keytar.setPassword(service, param.name, secret)
  console.log(response)
  return response
}

const clearSecret = async (param) => {
  await keytar.deletePassword(service, param.name)
}

module.exports = {
  getOrCreateSecret,
  createSecret,
  clearSecret,
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-credentials-mgr.html">credentials-mgr</a></li></ul><h3>Global</h3><ul><li><a href="global.html#logger">logger</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Mar 24 2019 17:10:50 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
